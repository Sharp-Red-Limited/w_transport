# Dart 1:
# -------
#
# Run unit tests:
#
#     $ pub run test
#
# Run integration tests:
#
#     $ node tool/server/sockjs.js
#     $ dart tool/server/server.dart
#     $ pub run test -P integration
#
#
# Dart 2:
# -------
#
# Run unit tests:
#
#     $ pub run build_runner test
#
# Run integration tests:
#
#     $ node tool/server/sockjs.js
#     $ dart tool/server/server.dart
#     $ pub run build_runner test -- -P integration
platforms:
  - chrome
  - vm

paths:
  - test/unit/http
  - test/unit/mocks
  - test/unit/ws

presets:
  dart2:
    exclude_tags: "no-dart2"

  integration:
    concurrency: 1
    paths:
      - test/integration/global_web_socket_monitor
      - test/integration/http
      - test/integration/platforms
      - test/integration/ws

  travis:
    reporter: expanded
    # The SockJS integration test server sometimes gets overloaded and rejects
    # connections. Retries are enabled during CI to mitigate these failures.
    retry: 3
